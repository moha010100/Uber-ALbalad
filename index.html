<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Uber Albalad</title>

  <style>
    :root{
      --yellow:#ffd400;
      --black:#0b0b0b;
      --card:#ffffff;
      --muted:#777;
      --shadow:0 6px 18px rgba(10,10,10,0.08);
      --radius:14px;
      --gap:24px;
    }

    body{
      margin:0;
      background:#f4f4f4;
      font-family:'Segoe UI', Tahoma;
      color:#111;
    }

    /* الشريط العلوي */
    .topbar{
      background:var(--yellow);
      padding:14px 20px;
      text-align:center;
      position:sticky;
      top:0;
      z-index:20;
      font-weight:700;
      font-size:20px;
    }
    .adminBtn{
      position:absolute;
      right:20px;
      top:10px;
      padding:8px 12px;
      border-radius:8px;
      background:#fff;
      border:1px solid #ddd;
      cursor:pointer;
      font-weight:600;
    }

    /* تخطيط الصفحة */
    .wrap{
      max-width:1200px;
      margin:25px auto;
      padding:0 14px;
      display:grid;
      grid-template-columns:70% 30%; /* طلبات 70% */
      gap:var(--gap);
    }

    /* الطلبات */
    .ordersCard{
      background:#fff;
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
    }
    .ordersList{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top:10px;
    }

    .orderCard{
      background:#fff;
      padding:12px;
      border-radius:12px;
      display:flex;
      gap:12px;
      border:1px solid #eee;
      align-items:center;
    }

    /* الصورة مكبرة بنسبة 70% */
    .orderCard img{
      width:70%;
      height:200px;
      object-fit:cover;
      border-radius:12px;
    }

    .orderMeta{
      flex:1;
    }

    /* لوحة المشرف */
    .adminCard{
      background:#fff;
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
      display:none;
      flex-direction:column;
      gap:12px;
    }
    .adminCard.active{
      display:flex;
    }

    /* أزرار */
    .btn{
      padding:10px 14px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:600;
    }
    .btn-primary{ background:#ffd400; color:#000; }
    .btn-secondary{ background:#eee; }
    .btn-danger{ background:#e03939; color:#fff; }

    /* النافذة */
    .modal{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.4);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:40;
    }
    .modal.show{
      display:flex;
    }
    .modalBox{
      background:#fff;
      padding:18px;
      border-radius:12px;
      width:92%;
      max-width:450px;
    }
    input{
      width:100%;
      padding:10px;
      margin-top:6px;
      border:1px solid #ddd;
      border-radius:8px;
    }
  </style>
</head>
<body>

  <div class="topbar">
    Uber Albalad
    <button id="openAdminBtn" class="adminBtn">المشرفين</button>
  </div>

  <div class="wrap">

    <!-- الطلبات -->
    <div class="ordersCard">
      <h2>قائمة الطلبات</h2>
      <div id="ordersList" class="ordersList"></div>
    </div>

    <!-- لوحة المشرف -->
    <div id="adminPanel" class="adminCard">
      <h3>لوحة المشرف</h3>
      <div id="adminInfo"></div>

      <div id="adminActions" style="display:none">
        <button id="btnAdd" class="btn btn-primary">إضافة طلب</button>
        <button id="btnReset" class="btn btn-secondary">إعادة ضبط</button>
        <button id="btnLogout" class="btn btn-danger">تسجيل خروج</button>
      </div>
    </div>

  </div>

  <!-- نافذة إضافة / تعديل -->
  <div id="modal" class="modal">
    <div class="modalBox">
      <h3 id="modalTitle">إضافة طلب</h3>

      <label>اسم الطلب</label>
      <input id="inputTitle" type="text">

      <label>رقم الديلفري</label>
      <input id="inputDelivery" type="text" placeholder="اكتب رقم الديلفري">

      <label>صورة الطلب</label>
      <input id="inputFile" type="file" accept="image/*">

      <br><br>
      <button class="btn btn-secondary" onclick="closeModal()">إلغاء</button>
      <button id="saveBtn" class="btn btn-primary">حفظ</button>
    </div>
  </div>

<script>
const ADMIN_CODE = "010100";
let isAdmin = sessionStorage.getItem("ua_isAdmin") === "1";

let orders = JSON.parse(localStorage.getItem("ua_orders") || "[]");

const adminPanel = document.getElementById("adminPanel");
const adminInfo = document.getElementById("adminInfo");
const adminActions = document.getElementById("adminActions");
const openAdminBtn = document.getElementById("openAdminBtn");

const ordersListEl = document.getElementById("ordersList");

const modal = document.getElementById("modal");
const inputTitle = document.getElementById("inputTitle");
const inputDelivery = document.getElementById("inputDelivery");
const inputFile = document.getElementById("inputFile");
const saveBtn = document.getElementById("saveBtn");

const btnAdd = document.getElementById("btnAdd");
const btnReset = document.getElementById("btnReset");
const btnLogout = document.getElementById("btnLogout");

let editingIndex = -1;
let tempImageData = "";

/* تحديث واجهة المشرف */
function updateAdminUI(){
  if(isAdmin){
    adminPanel.classList.add("active");
    adminInfo.innerText = "يمكنك الآن إدارة الطلبات";
    adminActions.style.display = "flex";
    openAdminBtn.innerText = "المشرف";
  } else {
    adminPanel.classList.remove("active");
    adminInfo.innerText = "اضغط على زر المشرفين للدخول بلوحة التحكم";
    adminActions.style.display = "none";
    openAdminBtn.innerText = "المشرفين";
  }
}

/* عرض الطلبات */
function renderOrders(){
  ordersListEl.innerHTML = "";
  if(orders.length === 0){
    ordersListEl.innerHTML =
      `<div style="text-align:center;color:#777;padding:40px">لا توجد طلبات حالياً</div>`;
    return;
  }

  orders.forEach((o,i)=>{
    ordersListEl.innerHTML += `
      <div class="orderCard">
        <img src="${o.image}">
        <div class="orderMeta">
          <h4>${o.title}</h4>
          <p>رقم الديلفري: <b>${o.delivery}</b></p>
        </div>

        ${isAdmin ? `
        <div>
          <button class="btn btn-secondary" onclick="openEdit(${i})">تعديل</button>
          <button class="btn btn-danger" onclick="deleteOrder(${i})">حذف</button>
        </div>` : ""}
      </div>
    `;
  });
}

/* دخول المشرف */
openAdminBtn.onclick = ()=>{
  if(isAdmin){
    adminPanel.classList.toggle("active");
    return;
  }
  let code = prompt("ادخل كود المشرف:");
  if(code === ADMIN_CODE){
    isAdmin = true;
    sessionStorage.setItem("ua_isAdmin","1");
    updateAdminUI();
    renderOrders();
  } else {
    alert("الكود غير صحيح");
  }
};

/* تسجيل خروج */
btnLogout.onclick = ()=>{
  if(!confirm("هل تريد تسجيل الخروج؟")) return;
  isAdmin = false;
  sessionStorage.removeItem("ua_isAdmin");
  updateAdminUI();
  renderOrders();
};

/* إضافة طلب */
btnAdd.onclick = ()=>{
  editingIndex = -1;
  tempImageData = "";
  inputTitle.value = "";
  inputDelivery.value = "";
  inputFile.value = "";
  modalTitle.innerText = "إضافة طلب";
  openModal();
};

/* رفع صورة */
inputFile.onchange = e=>{
  const f = e.target.files[0];
  if(!f) return;
  const reader = new FileReader();
  reader.onload = ()=> tempImageData = reader.result;
  reader.readAsDataURL(f);
};

/* حفظ */
saveBtn.onclick = ()=>{
  const title = inputTitle.value.trim();
  const delivery = inputDelivery.value.trim();

  if(!title){ alert("اكتب اسم الطلب"); return; }
  if(!delivery){ alert("اكتب رقم الديلفري"); return; }

  if(editingIndex >= 0){
    orders[editingIndex].title = title;
    orders[editingIndex].delivery = delivery;
    if(tempImageData) orders[editingIndex].image = tempImageData;
  } else {
    orders.unshift({ title, delivery, image: tempImageData });
  }

  localStorage.setItem("ua_orders", JSON.stringify(orders));
  closeModal();
  renderOrders();
};

/* تعديل */
function openEdit(i){
  editingIndex = i;
  const o = orders[i];
  modalTitle.innerText = "تعديل الطلب";
  inputTitle.value = o.title;
  inputDelivery.value = o.delivery;
  tempImageData = o.image;
  openModal();
}

/* حذف */
function deleteOrder(i){
  if(!confirm("حذف الطلب؟")) return;
  orders.splice(i,1);
  localStorage.setItem("ua_orders", JSON.stringify(orders));
  renderOrders();
}

/* نافذة */
function openModal(){ modal.classList.add("show") }
function closeModal(){ modal.classList.remove("show") }

/* بدء */
updateAdminUI();
renderOrders();
</script>

</body>
</html>
